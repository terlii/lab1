# -*- coding: utf-8 -*-
"""
–ó–∞–¥–∞–Ω–∏—è 2-4, –ó–∞–¥–∞—á–∞ 16: –£–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –º–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤ –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —Ñ–ª–∞–≥–∞
–í–∞—Ä–∏–∞–Ω—Ç 3
"""

import random

def sort_russian_flag():
    """
    –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤ –≤ –ø–æ—Ä—è–¥–∫–µ: –±–µ–ª—ã–π, —Å–∏–Ω–∏–π, –∫—Ä–∞—Å–Ω—ã–π (—Ä–æ—Å—Å–∏–π—Å–∫–∏–π —Ñ–ª–∞–≥)
    
    Returns:
        list: –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤
    """
    print("=" * 60)
    print("–ó–ê–î–ê–ù–ò–ï 2-4, –ó–ê–î–ê–ß–ê 16: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —Ñ–ª–∞–≥–∞")
    print("=" * 60)
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —Ñ–ª–∞–≥–∞
    flag_order = {"–±–µ–ª—ã–π": 0, "—Å–∏–Ω–∏–π": 1, "–∫—Ä–∞—Å–Ω—ã–π": 2}
    
    print("\n–í–≤–µ–¥–∏—Ç–µ —Ü–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª (–º–æ–∂–Ω–æ: –±–µ–ª—ã–π, —Å–∏–Ω–∏–π, –∫—Ä–∞—Å–Ω—ã–π)")
    print("–ò–ª–∏ –≤–≤–µ–¥–∏—Ç–µ '–ø—Ä–∏–º–µ—Ä' –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏")
    
    choice = input("–í–∞—à –≤—ã–±–æ—Ä: ").strip().lower()
    
    if choice == "–ø—Ä–∏–º–µ—Ä":
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤ –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞
        colors = generate_random_flag_array()
    else:
        # –†–∞–∑–±–∏—Ä–∞–µ–º –≤–≤–µ–¥–µ–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É
        colors = choice.split()
    
    # –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Ü–≤–µ—Ç–∞
    valid_colors = [c for c in colors if c in flag_order]
    invalid_colors = [c for c in colors if c not in flag_order]
    
    print(f"\nüì• –ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: {colors}")
    
    if invalid_colors:
        print(f"‚ö† –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Ü–≤–µ—Ç–∞ (–±—É–¥—É—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã): {invalid_colors}")
    
    if not valid_colors:
        print("‚ùå –ù–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Ü–≤–µ—Ç–æ–≤ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏")
        return []
    
    print(f"‚úÖ –î–æ–ø—É—Å—Ç–∏–º—ã–µ —Ü–≤–µ—Ç–∞: {valid_colors}")
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å–æ–≥–ª–∞—Å–Ω–æ –ø–æ—Ä—è–¥–∫—É —Ñ–ª–∞–≥–∞
    sorted_colors = sorted(valid_colors, key=lambda x: flag_order[x])
    
    print(f"\nüì§ –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ (—Ä–æ—Å—Å–∏–π—Å–∫–∏–π —Ñ–ª–∞–≥): {sorted_colors}")
    
    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–ª–∞–≥–∞
    print("\nüé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–ª–∞–≥–∞:")
    for color in sorted_colors:
        if color == "–±–µ–ª—ã–π":
            print("   ‚¨ú –ë–ï–õ–´–ô")
        elif color == "—Å–∏–Ω–∏–π":
            print("   üü¶ –°–ò–ù–ò–ô")
        elif color == "–∫—Ä–∞—Å–Ω—ã–π":
            print("   üü• –ö–†–ê–°–ù–´–ô")
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    is_correct = check_flag_order(sorted_colors)
    if is_correct:
        print("\n‚úÖ –§–ª–∞–≥ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ!")
    else:
        print("\n‚ùå –û—à–∏–±–∫–∞ –≤ –ø–æ—Ä—è–¥–∫–µ —Ñ–ª–∞–≥–∞!")
    
    return sorted_colors

def generate_random_flag_array(size=None):
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏.
    
    Args:
        size (int, optional): –†–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞
        
    Returns:
        list: –°–ª—É—á–∞–π–Ω—ã–π –º–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤
    """
    colors = ["–±–µ–ª—ã–π", "—Å–∏–Ω–∏–π", "–∫—Ä–∞—Å–Ω—ã–π"]
    
    if size is None:
        size = random.randint(5, 12)
    
    random_array = [random.choice(colors) for _ in range(size)]
    return random_array

def check_flag_order(colors):
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ—Ä—è–¥–æ–∫ —Ü–≤–µ—Ç–æ–≤ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º—É —Ñ–ª–∞–≥—É.
    
    Args:
        colors (list): –ú–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        
    Returns:
        bool: True –µ—Å–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
    """
    if not colors:
        return False
    
    # –§–ª–∞–≥ –¥–æ–ª–∂–µ–Ω –∏–¥—Ç–∏: –±–µ–ª—ã–π -> —Å–∏–Ω–∏–π -> –∫—Ä–∞—Å–Ω—ã–π
    flag_order = ["–±–µ–ª—ã–π", "—Å–∏–Ω–∏–π", "–∫—Ä–∞—Å–Ω—ã–π"]
    current_index = 0
    
    for color in colors:
        if color == flag_order[current_index]:
            continue
        elif current_index < 2 and color == flag_order[current_index + 1]:
            current_index += 1
        else:
            return False
    
    return True

def multiple_flag_sort():
    """
    –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤ —Ü–≤–µ—Ç–æ–≤.
    """
    print("\n" + "=" * 60)
    print("–°–û–†–¢–ò–†–û–í–ö–ê –ù–ï–°–ö–û–õ–¨–ö–ò–• –ú–ê–°–°–ò–í–û–í")
    print("=" * 60)
    
    arrays = []
    
    print("–í–≤–µ–¥–∏—Ç–µ –º–∞—Å—Å–∏–≤—ã —Ü–≤–µ—Ç–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –≤ —Å—Ç—Ä–æ–∫–µ).")
    print("–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–≤–æ–¥–∞ –æ—Å—Ç–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É –ø—É—Å—Ç–æ–π.")
    print("–ü—Ä–∏–º–µ—Ä: –±–µ–ª—ã–π —Å–∏–Ω–∏–π –∫—Ä–∞—Å–Ω—ã–π –±–µ–ª—ã–π —Å–∏–Ω–∏–π")
    
    while True:
        line = input(f"–ú–∞—Å—Å–∏–≤ {len(arrays) + 1}: ").strip()
        if not line:
            break
        
        colors = line.split()
        arrays.append(colors)
    
    if not arrays:
        print("–ú–∞—Å—Å–∏–≤—ã –Ω–µ –≤–≤–µ–¥–µ–Ω—ã")
        return
    
    print(f"\nüìä –ü–æ–ª—É—á–µ–Ω–æ {len(arrays)} –º–∞—Å—Å–∏–≤–æ–≤:")
    
    for i, arr in enumerate(arrays, 1):
        print(f"\n--- –ú–∞—Å—Å–∏–≤ {i} ---")
        print(f"–ò—Å—Ö–æ–¥–Ω—ã–π: {arr}")
        
        valid_colors = [c for c in arr if c in ["–±–µ–ª—ã–π", "—Å–∏–Ω–∏–π", "–∫—Ä–∞—Å–Ω—ã–π"]]
        if valid_colors:
            sorted_arr = sorted(valid_colors, 
                              key=lambda x: {"–±–µ–ª—ã–π": 0, "—Å–∏–Ω–∏–π": 1, "–∫—Ä–∞—Å–Ω—ã–π": 2}[x])
            print(f"–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: {sorted_arr}")
        else:
            print("–ù–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Ü–≤–µ—Ç–æ–≤")

def count_flag_statistics(colors):
    """
    –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ü–≤–µ—Ç–∞–º –≤ –º–∞—Å—Å–∏–≤–µ.
    
    Args:
        colors (list): –ú–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤
    """
    print("\n" + "=" * 60)
    print("–°–¢–ê–¢–ò–°–¢–ò–ö–ê –¶–í–ï–¢–û–í")
    print("=" * 60)
    
    counts = {
        "–±–µ–ª—ã–π": colors.count("–±–µ–ª—ã–π"),
        "—Å–∏–Ω–∏–π": colors.count("—Å–∏–Ω–∏–π"),
        "–∫—Ä–∞—Å–Ω—ã–π": colors.count("–∫—Ä–∞—Å–Ω—ã–π")
    }
    
    total = len(colors)
    
    print(f"–í—Å–µ–≥–æ —Ü–≤–µ—Ç–æ–≤: {total}")
    print(f"\nüìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:")
    print(f"  ‚¨ú –ë–µ–ª—ã–π:   {counts['–±–µ–ª—ã–π']:2d} ({counts['–±–µ–ª—ã–π']/total*100:5.1f}%)")
    print(f"  üü¶ –°–∏–Ω–∏–π:   {counts['—Å–∏–Ω–∏–π']:2d} ({counts['—Å–∏–Ω–∏–π']/total*100:5.1f}%)")
    print(f"  üü• –ö—Ä–∞—Å–Ω—ã–π: {counts['–∫—Ä–∞—Å–Ω—ã–π']:2d} ({counts['–∫—Ä–∞—Å–Ω—ã–π']/total*100:5.1f}%)")
    
    # ASCII –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞
    print(f"\nüìà –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞:")
    max_count = max(counts.values())
    for color, count in counts.items():
        bar = '‚ñà' * int(40 * count / max_count) if max_count > 0 else ''
        symbol = '‚¨ú' if color == '–±–µ–ª—ã–π' else 'üü¶' if color == '—Å–∏–Ω–∏–π' else 'üü•'
        print(f"  {symbol} {color}: {bar} {count}")

def interactive_flag_builder():
    """
    –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ñ–ª–∞–≥–∞.
    """
    print("\n" + "=" * 60)
    print("–ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ô –ö–û–ù–°–¢–†–£–ö–¢–û–† –§–õ–ê–ì–ê")
    print("=" * 60)
    
    print("\n–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π —Ñ–ª–∞–≥, –¥–æ–±–∞–≤–ª—è—è —Ü–≤–µ—Ç–∞ –ø–æ –æ–¥–Ω–æ–º—É:")
    
    flag = []
    
    while True:
        print(f"\n–¢–µ–∫—É—â–∏–π —Ñ–ª–∞–≥: {flag}")
        print("–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ü–≤–µ—Ç–∞: –±–µ–ª—ã–π, —Å–∏–Ω–∏–π, –∫—Ä–∞—Å–Ω—ã–π")
        print("–ö–æ–º–∞–Ω–¥—ã: +—Ü–≤–µ—Ç (–¥–æ–±–∞–≤–∏—Ç—å), - (—É–¥–∞–ª–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π), –≥ (–≥–æ—Ç–æ–≤–æ)")
        
        cmd = input("> ").strip().lower()
        
        if cmd == "–≥":
            break
        elif cmd == "-":
            if flag:
                removed = flag.pop()
                print(f"–£–¥–∞–ª–µ–Ω —Ü–≤–µ—Ç: {removed}")
            else:
                print("–§–ª–∞–≥ –ø—É—Å—Ç")
        elif cmd.startswith("+") and cmd[1:] in ["–±–µ–ª—ã–π", "—Å–∏–Ω–∏–π", "–∫—Ä–∞—Å–Ω—ã–π"]:
            color = cmd[1:]
            flag.append(color)
            print(f"–î–æ–±–∞–≤–ª–µ–Ω —Ü–≤–µ—Ç: {color}")
            
            # –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–µ–∫—É—â–∏–π —Ñ–ª–∞–≥
            sorted_flag = sorted(flag, 
                               key=lambda x: {"–±–µ–ª—ã–π": 0, "—Å–∏–Ω–∏–π": 1, "–∫—Ä–∞—Å–Ω—ã–π": 2}[x])
            if flag == sorted_flag:
                print("‚úÖ –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π!")
            else:
                print("‚ùå –ü–æ—Ä—è–¥–æ–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π! –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: –±–µ–ª—ã–π, —Å–∏–Ω–∏–π, –∫—Ä–∞—Å–Ω—ã–π")
        else:
            print("–ù–µ–≤–µ—Ä–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞")
    
    if flag:
        print(f"\nüì§ –ò—Ç–æ–≥–æ–≤—ã–π —Ñ–ª–∞–≥: {flag}")
        count_flag_statistics(flag)
        
        # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
        print("\nüé® –í–∞—à —Ñ–ª–∞–≥:")
        for color in flag:
            if color == "–±–µ–ª—ã–π":
                print("   ‚¨ú", end=" ")
            elif color == "—Å–∏–Ω–∏–π":
                print("   üü¶", end=" ")
            elif color == "–∫—Ä–∞—Å–Ω—ã–π":
                print("   üü•", end=" ")
        print()

def demonstrate_examples():
    """
    –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö.
    """
    print("\n" + "=" * 60)
    print("–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –†–ê–ë–û–¢–´ –ù–ê –ü–†–ò–ú–ï–†–ê–•")
    print("=" * 60)
    
    examples = [
        ["–∫—Ä–∞—Å–Ω—ã–π", "–±–µ–ª—ã–π", "—Å–∏–Ω–∏–π"],
        ["—Å–∏–Ω–∏–π", "–∫—Ä–∞—Å–Ω—ã–π", "–±–µ–ª—ã–π", "—Å–∏–Ω–∏–π"],
        ["–±–µ–ª—ã–π", "–∫—Ä–∞—Å–Ω—ã–π", "—Å–∏–Ω–∏–π", "–±–µ–ª—ã–π", "–∫—Ä–∞—Å–Ω—ã–π"],
        ["–∫—Ä–∞—Å–Ω—ã–π", "—Å–∏–Ω–∏–π", "–±–µ–ª—ã–π", "–∫—Ä–∞—Å–Ω—ã–π", "—Å–∏–Ω–∏–π", "–±–µ–ª—ã–π"],
        ["–±–µ–ª—ã–π", "–±–µ–ª—ã–π", "—Å–∏–Ω–∏–π", "—Å–∏–Ω–∏–π", "–∫—Ä–∞—Å–Ω—ã–π", "–∫—Ä–∞—Å–Ω—ã–π"]
    ]
    
    flag_order = {"–±–µ–ª—ã–π": 0, "—Å–∏–Ω–∏–π": 1, "–∫—Ä–∞—Å–Ω—ã–π": 2}
    
    for i, example in enumerate(examples, 1):
        print(f"\n--- –ü—Ä–∏–º–µ—Ä {i} ---")
        print(f"–ò—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤: {example}")
        
        sorted_example = sorted(example, key=lambda x: flag_order[x])
        print(f"–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: {sorted_example}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞
        is_correct = check_flag_order(sorted_example)
        status = "‚úÖ" if is_correct else "‚ùå"
        print(f"–°—Ç–∞—Ç—É—Å: {status}")

def main():
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.
    """
    while True:
        print("\n" + "=" * 60)
        print("–í–´–ë–ï–†–ò–¢–ï –†–ï–ñ–ò–ú –†–ê–ë–û–¢–´:")
        print("=" * 60)
        print("1 - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —Ü–≤–µ—Ç–æ–≤")
        print("2 - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤")
        print("3 - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ñ–ª–∞–≥–∞")
        print("4 - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ü–≤–µ—Ç–∞–º")
        print("5 - –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö")
        print("6 - –í—ã–π—Ç–∏")
        
        choice = input("–í–∞—à –≤—ã–±–æ—Ä (1-6): ").strip()
        
        if choice == "1":
            sort_russian_flag()
        
        elif choice == "2":
            multiple_flag_sort()
        
        elif choice == "3":
            interactive_flag_builder()
        
        elif choice == "4":
            colors = input("–í–≤–µ–¥–∏—Ç–µ –º–∞—Å—Å–∏–≤ —Ü–≤–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª: ").split()
            valid_colors = [c for c in colors if c in ["–±–µ–ª—ã–π", "—Å–∏–Ω–∏–π", "–∫—Ä–∞—Å–Ω—ã–π"]]
            if valid_colors:
                count_flag_statistics(valid_colors)
            else:
                print("–ù–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Ü–≤–µ—Ç–æ–≤")
        
        elif choice == "5":
            demonstrate_examples()
        
        elif choice == "6":
            print("–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
            break
        
        else:
            print("–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 6")

if __name__ == "__main__":
    main()